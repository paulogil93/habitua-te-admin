var API_URL="API_BASE_URL",ADMIN_API_KEY="ADMIN_API_KEY";$(document).ready(function(){$.ajax({url:"API_BASE_URL/products/",type:"GET",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},success:function(a){$("table").bootstrapTable({data:a})}}),$("#deleteBtn").click(function(){var a=document.getElementById("productID").innerHTML;$.ajax({url:"API_BASE_URL/products/",type:"DELETE",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},success:function(a){console.log(a),window.location.reload()},error:function(a){console.log(a)}})}),$("#addModal").on("show.bs.modal",function(){setAddModalCategories()}),$("#addBtn").click(function(){var a,b=document.getElementById("p_name").value,c=document.getElementById("p_proof").value,d=document.getElementById("p_country").value,e=document.getElementById("p_price").value,f=document.getElementById("p_url").value,g=document.getElementById("p_description").value,h=document.getElementById("p_available").value,i=document.getElementById("cat_sel").value;if(a="Sim"==h?"True":"False",""==b||""==d||""==c||""==e||!1||""==g)alert("Por favor preencha os campos necess\xE1rios!");else{var j="name="+b+"&category_id="+i+"&description="+g+"&proof="+c+"&country="+d+"&price="+e+"&available="+a+"&picture="+f;$.ajax({url:"API_BASE_URL/products/?"+j,type:"POST",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},success:function(a){clearFields(),console.log(a),window.location.reload()},error:function(a){console.log(a)}})}})});function clearFields(){document.getElementById("p_name").value="",document.getElementById("p_proof").value="",document.getElementById("p_country").value="",document.getElementById("p_price").value="",document.getElementById("p_url").value="",document.getElementById("p_description").value="",document.getElementById("p_available").value="",document.getElementById("cat_sel").value=""}$(function(){$("form").submit(function(){var a,b=document.getElementById("id").value,c=document.getElementById("product_name").value,d=document.getElementById("proof").value,e=document.getElementById("country").value,f=document.getElementById("price").value,g=document.getElementById("url").value,h=document.getElementById("description").value,i=document.getElementById("available").value,j=document.getElementById("categories_select").value;a="Sim"==i?"True":"False";var k="name="+c+"&category_id="+j+"&description="+h+"&proof="+d+"&country="+e+"&price="+f+"&available="+a+"&picture="+g;return $.ajax({url:"API_BASE_URL/products/"+b+"/"+"?"+k,type:"PUT",contentType:"application/json",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},async:!1,success:function(a){console.log(a),window.location.reload()},error:function(a){console.log(a)}}),!1})}),window.operateEvents={"click .edit":function(a,b,c){$("#editModal").modal("toggle"),getCategories(),setModal(c)},"click .delete":function(a,b,c){$("#deleteModal").modal("toggle"),product=document.getElementById("deleteProduct"),product.innerHTML="Tem a certeza que pretende eliminar o produto '"+c.name+"'?",id=document.getElementById("productID"),id.innerHTML=c.id}};function getCategories(){$.ajax({url:"API_BASE_URL/categories/",type:"GET",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},async:!1,success:function(a){var b=$("#categories_select");b.empty(),$.each(a,function(a,c){b.append("<option value="+c.id+">"+c.name+"</option>")}),console.log(a)}})}function setAddModalCategories(){$.ajax({url:"API_BASE_URL/categories/",type:"GET",dataType:"json",headers:{"X-Api-Key":ADMIN_API_KEY},async:!1,success:function(a){var b=$("#cat_sel");b.empty(),$.each(a,function(a,c){b.append("<option value="+c.id+">"+c.name+"</option>")}),console.log(a)}})}function setModal(a){var b=!1==a.available?"N\xE3o":"Sim";var c=document.getElementById("id"),d=document.getElementById("product_name"),e=document.getElementById("proof"),f=document.getElementById("country"),g=document.getElementById("price"),h=document.getElementById("url"),i=document.getElementById("description"),j=document.getElementById("available"),k=document.getElementById("categories_select");c.value=a.id,d.value=a.name,e.value=a.proof,f.value=a.country,g.value=a.price,h.value=a.picture,i.value=a.description,j.value=b,k.value=a.category_id}function imageFormatter(a){return"<img width=\"100px\" height=\"75px\" class=\"rounded\" src=\""+a+"\" />"}function availableFormatter(a){return!0==a?"Sim":"N\xE3o"}function proofFormatter(a){return a+" %"}function priceFormatter(a){return a+" \u20AC"}function editFormatter(){return"<a class=\"edit\" href=\"javascript:void(0)\" title=\"Editar\"><i class=\"fa fa-edit\"></i></a>  "}function deleteFormatter(){return"<a class=\"delete\" href=\"javascript:void(0)\" title=\"Eliminar\"><i class=\"fa fa-trash text-danger\"></i></a>  "}
